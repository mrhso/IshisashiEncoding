# UTF-VLQ 系列

## 所收编码
### 架空编码
- UTF-VLQ
- WTF-VLQ

## 解说
UTF-VLQ 是使用 VLQ 的 Unicode 实作编码。

## 字节结构
UTF-VLQ 如下：

|字节数|第一字节|第二字节|第三字节|码位数|注释|
|-|-|-|-|-|-|
|单字节|0x00~0x7F|||128||
|双字节|0x80~0xEF|0x00~0xFF||16256||
|三字节|0xF0~0xFF|0x00~0xFF|0x00~0xFF|1095680|0x83B000~0x83BF7F 通常不认为是合法码位。|

WTF-VLQ 如下：

|字节数|第一字节|第二字节|第三字节|码位数|注释|
|-|-|-|-|-|-|
|单字节|0x00~0x7F|||128||
|双字节|0x80~0xEF|0x00~0xFF||16256||
|三字节|0xF0~0xFF|0x00~0xFF|0x00~0xFF|1097728|0x83B000~0x83BF7F 被启用。|

## 与 Unicode 的对应关系
### VLQ
首先将 Unicode 码表示成二进制，并去掉前面的 0。

如果位数不是 7 的倍数，则在前面填充 0，直到位数为 7 的倍数为止。

每 7 位进行分割。除了最后一组，所有组前面都填充 1。最后一组在前面填充 0。

以 U+4E00 为例。

表示成二进制，得 0100111000000000。

去掉前面的 0，得 100111000000000。

填充 0 并分割，得 0000001 0011100 0000000。

填充 1 或 0，得 10000001 10011100 00000000。

所以最终结果为 0x819C00。

### U+D800~U+DFFF
这一块不会定义任何字符，都拿来给 UTF-16 表示 non-BMP。

如果启用这一块，那这被叫作 WTF-VLQ。
